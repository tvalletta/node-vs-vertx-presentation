<!doctype html>
<html>
    <head>
        <title>Node.js vs. Vert.x</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="author" content="Thomas A. Valletta" />
        <meta name="author" content="Mike Heath" />
        <link href="css/impress.css" rel="stylesheet" />
        <link href="css/prettify.css" rel="stylesheet" />
        <script type="text/javascript" src='js/jquery-1.8.2.min.js'></script>
        <script type="text/javascript" src='js/prettify.js'></script>
        <style type="text/css">
            table, th, td
            {
                border: 1px solid black;
            }
        </style>
    </head>
    <body onload='prettyPrint()'>
		<p class="fallback-message">
		    Your browser doesn't support impress.js.  Try Chrome or Safari.
		</p>
		<div id="impress">
			<div id="title" class="step" data-x="600" data-y="0" data-z="-500" data-rotate-y="-75">
			    <h1>Node.js vs. Vert.x</h1>
			    <h4>By Mike Heath &amp; Thomas A. Valletta</h4>
			</div>
			<div class="step" data-x="0" data-y="0" data-z="0">
				<h2>Intro</h2>
			</div>
			<div class="step" data-x="50" data-y="100" data-z="-100">
				<h4>Mike Heath</h4>
			</div>
			<div class="step" data-x="50" data-y="200" data-z="-100">
				<h4>Thomas A. Valletta</h4>
			</div>
			<div class="step" data-x="0" data-y="800" data-z="">
				<h2>Node.js</h2>
				<!--
					Notes
					+ - - Performance - - +
					+ http://pepijndevos.nl/js-server-benchmark-nodejs-rhino/
					+ https://axtaxt.wordpress.com/2011/09/25/benchmark-rhino-vs-chrome-v8-on-server-side/
					+ https://github.com/felixge/faster-than-c

				-->
			</div>
			<div class="step" data-x="0" data-y="1100" data-z="">
				
			</div>
			<div class="step" data-x="-100" data-y="1027" data-z="-800" data-scale=".8" data-focus='javascript'>
				
			</div>
			<div class="step invisible right" data-x="120" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				JavaScript<br/>is the only language<br/>that runs natively<br/>on the most popular<br/>and prolific virtual<br/>machine of our day:<br/>the Browser.
			</div>
			<div class="step invisible right" data-x="320" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				Wednesday,<br/>September 12th 2012<br/>RedMonk published its<br/>programming language<br/>popularity ranking.
			</div>
			<div class="step invisible right" data-x="520" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				<ol style='font-size: 24px;'>
					<li>JavaScript</li>
					<li>Java</li>
					<li>PHP</li>
					<li>Python</li>
					<li>Ruby</li>
					<li>C#</li>
					<li>C++</li>
					<li>C</li>
					<li>Objective-C</li>
					<li>Shell</li>
					<li>Perl</li>
					<li>Scala</li>
					<li>Haskell</li>
					<li>ASP</li>
					<li>Assembly</li>
					<li>ActionScript</li>
					<li>R</li>
					<li>Visual Basic</li>
					<li>CoffeeScript</li>
					<li>Groovy</li>
				</ol>
			</div>
			<div class="step invisible" data-x="-420" data-y="990" data-z="-780" data-scale=".03" data-rotate-y="90" data-rotate-z="-90">
				<img src='img/JavaScript-logo-600x600.png'/>
			</div>
			<div class="step" data-x="-100" data-y="1100" data-z="-800" data-scale=".8" data-focus='v8'>
				
			</div>
			<div class="step invisible right" data-x="120" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				According to the<br/>Computer Language<br/>Benchmarks Game,<br/>V8 is:
			</div>
			<div class="step invisible right" data-x="320" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				<table>
					<tbody>
						<tr>
							<td>Language</td>
							<td>V8 speed</td>
						</tr>
						<tr>
							<td>C</td>
							<td>2.2 times slower</td>
						</tr>
						<tr>
							<td>Java</td>
							<td>1.4 times slower</td>
						</tr>
						<tr>
							<td>C# Mono</td>
							<td>Same</td>
						</tr>
						<tr>
							<td>Erlang</td>
							<td>4 times faster</td>
						</tr>
						<tr>
							<td>Ruby</td>
							<td>14 times faster</td>
						</tr>
						<tr>
							<td>PHP</td>
							<td>15 times faster</td>
						</tr>
						<tr>
							<td>Python</td>
							<td>15.5 times faster</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="step invisible right" data-x="520" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				These benchmarks were<br/>achieved using approximately<br/>half the memory and<br/>a third of the code<br/>of Java.
			</div>
			<div class="step" data-x="-100" data-y="1173" data-z="-800" data-scale=".8" data-focus='modules'>
				
			</div>
			<div class="step invisible right" data-x="120" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				<h1>npm</h1>
			</div>
			<div class="step invisible right" data-x="320" data-y="1027" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				<ul>
					<li>15,802 modules</li>
					<li>654,524 downloads in 24 hr</li>
					<li>3,155,813 downloads in 7 days</li>
					<li>11,638,707 downloads in 30 days</li>
				</ul>
			</div>
			<div class="step" data-x="-100" data-y="1246" data-z="-800" data-scale=".8" data-focus='adoption'>

			</div>
			<div class="step invisible right" data-x="320" data-y="1246" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				<script type="text/javascript" src="http://www.google.com/trends/embed.js?hl=en-US&q=node.js,+vert.x,+netty&cmpt=q&content=1&cid=TIMESERIES_GRAPH_0&export=5&w=500&h=330"></script>
			</div>
			<div class="step" data-x="-100" data-y="1319" data-z="-800" data-scale=".8" data-focus='simplicity'>

			</div>
			<div class="step invisible right" data-x="320" data-y="1319" data-z="-800" data-scale=".8" data-rotate-y='-75'>
				Hello World
			</div>
			<div class="step invisible" data-x="520" data-y="1319" data-z="-600" data-scale=".8" data-rotate-y='-75'>
<pre class='prettyprint lang-js' >
console.log('hello');
setInterval(function() {
	console.log('world');
}, 1000);
</pre>	
			</div>
			<div class="step invisible right" data-x="720" data-y="1319" data-z="-400" data-scale=".8" data-rotate-y='-75'>
				Simple Web Server
			</div>
			<div class="step invisible" data-x="920" data-y="1319" data-z="-200" data-scale=".8" data-rotate-y='-75'>
<pre class='prettyprint lang-js' >
var http = require('http');

var s = http.createServer(function(req, res) {
	res.writeHead(200, {'content-type': 'text/plain'});
	res.end("hello world!");
});

s.listen(8088);
</pre>
			</div>
			<div class="step invisible right" data-x="1120" data-y="1319" data-z="0" data-scale=".8" data-rotate-y='-75'>
				Simple Chat Server
			</div>
			<div class="step invisible" data-x="1320" data-y="1319" data-z="200" data-scale=".8" data-rotate-y='-75'>
<pre class='prettyprint lang-js' style='font-size: 20px'>
var net = require('net');

var sockets = [];

var s = net.Server(function(socket) {
	sockets.push(socket);
	
	socket.on('data', function(d) {
		for (var i = 0; i < sockets.length; i++) {
			if (sockets[i] == socket) continue;
			sockets[i].write(d);
		}
	});
	
	socket.on('end', function() {
		var i = sockets.indexOf(socket);
		sockets.splice(i, 1);
	});
});

s.listen(8089);
</pre>
			</div>
			<div class="step clarify" data-x="0" data-y="1100" data-z="-800">
		    	<ul>
		    		<li class='focus' data-focus-id='javascript'>JavaScript</li>
		    		<li class='focus' data-focus-id='v8'>V8</li>
		    		<li class='focus' data-focus-id='modules'>modules</li>
		    		<li class='focus' data-focus-id='adoption'>adoption</li>
		    		<li class='focus' data-focus-id='simplicity'>simplicity</li>
		    	</ul>
			</div>
			<div class="step" data-x="0" data-y="2000">
				<h2>Now a little about...</h2>
				<h4>...some other technology whose name I have forgotten</h4>
			</div>
			<div class="step" data-x="0" data-y="3400">
				<h1>Let's fight!</h1>
			</div>



			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="1000" data-y="3400">
                <h2>Reliability</h2>
            </div>
            <div class="step invisible" data-x="1000" data-y="3400" data-z="-2000">
                <h3>Sample of Apps Running on Private Cloud Foundry Deployment</h3>
                <table>
                    <tr>
                        <td>Technology</td>
                        <td>Number of Apps</td>
                        <td>Number of Servers</td>
                        <td>Number of crashes over 30 days</td>
                    </tr>
                    <tr>
                        <td>Ruby on Rails</td>
                        <td>12</td>
                        <td>32</td>
                        <td>19</td>
                    </tr>
                    <tr>
                        <td>Ruby on Rails (JRuby and Tomcat)</td>
                        <td>4</td>
                        <td>20</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>Node.js</td>
                        <td>6</td>
                        <td>12</td>
                        <td>58</td>
                    </tr>
                </table>
                <p>*<b>Source:</b> vcap-dev mailing list</p>
            </div>
            <div class="step invisible" data-x="1000" data-y="3400" data-z="-2300">
            	<h1>"Node has been amazingly stable."</h1>
            	<h4>-Eran Hammer, hueniverse</h4>
            </div>
            <div class="step invisible" data-x="1000" data-y="3400" data-z="-2600">
            	<h2>Companies that use Node.js:</h2>
            	<ul>
            		<li>Twitter</li>
            		<li>Microsoft</li>
            		<li>Ebay</li>
            		<li>Yahoo</li>
            		<li>Yammer</li>
            	</ul>
            	<p>https://github.com/joyent/node/wiki/Projects,-Applications,-and-Companies-Using-Node</p>
            </div>


			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="1000" data-y="4400">
                <h2>Community</h2>
            </div>
            <div class="step invisible" data-x="2000" data-y="4400" data-z="-2000">
                <h3>Everyone has heard of Node.js, Vert.x sits quietly in its own little corner of the Internet</h3>
            </div>

			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="1000" data-y="5400">
                <h2>Performance</h2>
            </div>

            <div class="step" data-x="2000" data-y="5400">
                <h3>Vert.x is faster. There are plenty of benchmarks that show this.</h3>
            </div>

            <div class="step" data-x="3000" data-y="5400">
                <h3>However, V8 is MUCH faster than Rhino, the JavaScript parser in Vert.x.</h3>
            </div>

            <div class="step" data-x="4000" data-y="5400">
                <h3>Nashorn compiles JavaScript to Java byte-code, 10x faster than Rhino.</h3>
                <h4>Will be open sourced December 6.</h4>
            </div>

            <div class="step" data-x="5000" data-y="5400">
		<h3>For most cases performance doesn't matter as much as we think it does.</h3>
	    </div>

            <div class="step" data-x="6000" data-y="5400">
                <h3>For the cases where performance matters, Vert.x give you more choices.</h3>
                <h4>You're not limited to JavaScript.</h4>
            </div>

            <div class="step" data-x="7000" data-y="5400">
                <h2>It's easier to fix performance than it is to fix ugly.</h2>
            </div>

            <div class="step" data-x="8000" data-y="5400">
                <h2>The JVM comes with legacy cruft and a big memory footprint. Vert.x can't fix this.</h2>
            </div>

	<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="1000" data-y="6400">
                <h2>Non-blocking code</h2>
            </div>

            <div class="step" data-x="2000" data-y="6400">
                <h3>Node is built from the ground-up to be non-blocking.</h3>
		<h3>Everything in Node is non-blocking (except the things that aren't).</h3>
                <h3>Good luck finding good non-blocking libraries for Vert.x</h3>
            </div>

            <div class="step" data-x="3000" data-y="6400">
                <h3>Vert.x can still use blocking code.</h3>
                <h3>The JVM is a multi-threaded runtime. Push the blocking to another thread</h3>
            </div>

            <div class="step" data-x="4000" data-y="6400">
<pre class='prettyprint lang-js' style='font-size: 20px'>
load('vertx.js')

var threadPool = java.util.concurrent.Executors.newCachedThreadPool();

vertx.createHttpServer().requestHandler(function(req) {
    req.response.putHeader('Content-type', 'text/plain;UTF-8');

    threadPool.execute(function() {
        var TwitterFactory = twitter4j.TwitterFactory;
        var Query          = twitter4j.Query;

        var twitter = new TwitterFactory().instance;
        var query   = new Query("vertx");
        query.count = 100;

        do {
	    var result = twitter.search(query);
            var tweets = result.tweets;

            for each (tweet in tweets) {
                request.send("@" + tweet.user.screenName + " -- " + tweet.text + "\n);
            }
        } while (query = result.nextQuery());
        req.response.end();
    });
}).listen(8080);
</pre>
            </div>


            <!-- - - about threading and concurrency - - -->
			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="3000" data-y="3400">
                <h2>Threading</h2>
            </div>
            <div class="step invisible" data-x="3000" data-y="3400" data-z="-2000">
            	<h2>For small sites...</h2>
            	<ul>
            		<li>Single server</li>
            		<li>Single process is more efficent</li>
            		<li>No reason for complex threading</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="3400" data-z="-2300">
            	<h2>For large sites...</h2>
            	<ul>
            		<li>Lots of servers (concurrency)</li>
            		<li>Single process is more efficent</li>
            		<li>No reason for complex threading</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="3400" data-z="-2600">
            	<h2>What about fibonaci (image processing)</h2>
            	<ul>
            		<li>Delegate to a specialized platform</li>
            		<li>Google Compute Engine?</li>
            		<li>Likely C instead of Java</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="3400" data-z="-2900">
            	<h2>Specialization</h2>
            	<ul>
            		<li>Web Server</li>
            		<li>Application Server</li>
            		<li>Database Server</li>
            	</ul>
            </div>


            <!-- - - serving static files from node - - -->
			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="3000" data-y="4400">
            	<h2>Static File Performance</h2>
            </div>
            <div class="step invisible" data-x="3000" data-y="4400" data-z="-2000">
            	<h2>Default Express Middleware</h2>
            	<ul>
					<li>basicAuth()</li>
					<li>bodyParser()</li>
					<li>compress()</li>
					<li>cookieParser()</li>
					<li>cookieSession()</li>
					<li>csrf()</li>
					<li>directory()</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="4400" data-z="-2300">
            	<h2>Optional Express Middleware</h2>
            	<ul style="font-size: 8px; line-height: 9px;">
					<li>bundle-up</li>
					<li>connect_facebook</li>
					<li>connect_json</li>
					<li>connect-airbrake</li>
					<li>connect-assetmanager</li>
					<li>connect-assets</li>
					<li>connect-auth</li>
					<li>connect-compiler</li>
					<li>connect-dojo</li>
					<li>connect-domain</li>
					<li>connect-force-domain</li>
					<li>connect-http-signature</li>
					<li>connect-proxy</li>
					<li>connect-roles</li>
					<li>connect-rpx</li>
					<li>connect-views</li>
					<li>cookie-sessions</li>
					<li>dispatch</li>
					<li>everyauth</li>
					<li>express-chromeframe</li>
					<li>express-errors</li>
					<li>facebook-wrapper</li>
					<li>form2json</li>
					<li>formaline</li>
					<li>http-accept</li>
					<li>merge-js</li>
					<li>mincer</li>
					<li>minj</li>
					<li>monomi</li>
					<li>node_signedcookies</li>
					<li>node-facebook-session-cookie</li>
					<li>passport</li>
					<li>pound</li>
					<li>quip</li>
					<li>resource-router</li>
					<li>resty</li>
					<li>session-web-sockets</li>
					<li>session.js</li>
					<li>trust-reverse-proxy</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="4400" data-z="-2600">
            	<h2>Reasons to use a CDN</h2>
            	<ul>
					<li>Global cache</li>
					<li>Lower latency</li>
					<li>Network requests never hit your server</li>
					<li>cookieless domain</li>
            	</ul>
            </div>


            <!-- - - developer satisfaction - - -->
			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="3000" data-y="5400">
            	<h2>Developer Satisfaction</h2>
            </div>
            <div class="step invisible" data-x="3000" data-y="5400" data-z="-2000">
            	<h2>Developer Excitement: Java</h2>
            	<ul>
					<li>Clean Language</li>
					<li>Great Marketability</li>
					<li>Med Innovation Production</li>
					<li>Many Platform Break-outs</li>
					<li>Owned by Oracle</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="5400" data-z="-2300">
            	<h2>Developer Excitement: Objective C</h2>
            	<ul>
					<li>Strange Language</li>
					<li>Good Marketability</li>
					<li>Good Innovation Production</li>
					<li>Few Platform Break-outs</li>
					<li>Owned by Apple</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="5400" data-z="-2600">
            	<h2>Developer Excitement: Objective C</h2>
            	<ul>
					<li>Lovable Language</li>
					<li>Great Marketability</li>
					<li>Outstanding Innovation Production</li>
					<li>Overwhelming Platform Break-outs</li>
					<li>Owned by nobody</li>
            	</ul>
            </div>


            <!-- - - Response to Polyglot - - -->
			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step" data-x="3000" data-y="6400">
            	<h2>Polyglot</h2>
            </div>
            <div class="step invisible" data-x="3000" data-y="6400" data-z="-2000">
            	<h2>Polyglot: Irrelevant</h2>
            	<h2>Languages that you will not use:</h2>
            	<ul>
					<li>Java</li>
					<li>Ruby</li>
					<li>Groovy</li>
					<li>Python</li>
            	</ul>
            </div>
            <div class="step invisible" data-x="3000" data-y="6400" data-z="-2300">
            	<h2>Because their libraries block</h2>
            </div>
            <div class="step invisible" data-x="3000" data-y="6400" data-z="-2600">
            	<h2>Nobody uses:</h2>
            	<ul>
					<li>Netty</li>
					<li>Event Machine</li>
					<li>Twisted</li>
					<li>Tornado</li>
            	</ul>
            </div>



			<div class="step" data-x="2400" data-y="5000" data-z="5000"></div>
            <div class="step invisible" data-x="-250" data-y="300" data-rotate-x="20" data-rotate-y="-50" data-rotate-z="70" data-scale="1">
			    <br/><br/><br/><br/><br/>
			    <h6>Thanks!</h6>
			</div>

            <div id="eventdriven" class="step" data-x="1000" data-y="7400">
	            <h3>Event-driven Architecture</h3>
	            <ul style="font-size: 36px">
	                <li>Scalable alternative to thread-per-connection</li>
	                <li>Single thread handles multiple network connections</li>
	                <li>Uses reactor pattern for demultiplexing</li>
	                <li>Nginx, Twisted, EventMachine, Grizzly, Netty, Node.js, vert.x, etc.</li>
	            </ul>
            </div>

		</div>
    <script type="text/javascript" src="js/impress.js"></script>
    <script>
    	var el = document.getElementById("impress");
    	impress().init();

    	var focusList = [];

    	el.addEventListener("impress:stepenter", function (event) {
    		var focus = $(event.target).attr('data-focus');
    		if (focus) {
    			var $target = $('.focus[data-focus-id="' + focus + '"]');
    			if ($target[0]) {
	    			$target.addClass('clarify');
	    			focusList.push($target);
    			}
    		}
        }, false);

    	el.addEventListener("impress:stepleave", function (event) {
    		for (var i = 0, cnt = focusList.length; i < cnt; i++) {
    			focusList[i].removeClass('clarify');
    		}
    		focusList = [];
        }, false);

    </script>
    </body>
</html>
